language: r
sudo: true
cache: packages
warnings_are_errors: true

addons:
  apt:
    sources:
      - sourceline: 'ppa:ubuntugis/ppa'
    packages:
      - libmagick++-dev
      - libudunits2-dev
      - libproj-dev
      - libgeos-dev
      - libgdal-dev

before_install:
  - Rscript -e "remotes::install_github('ropensci/rrricanesdata')"
  - Rscript -e "remotes::install_github('ropensci/rnaturalearthhires')"

matrix:
  include:
  - r: oldrel
  - r: release
    after_success: Rscript -e "covr::codecov()"
    before_cache: Rscript -e "remotes::install_cran('pkgdown')"
    deploy:
      provider: script
      script:
        - Rscript -e "pkgdown::deploy_site_github(verbose = TRUE)"
      skip_cleanup: true
      on:
        all_branches: true
        condition: $TRAVIS_BRANCH =~ ^master|develop$
  - r: devel
